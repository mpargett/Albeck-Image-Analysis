%IQ_GETCAMERAQE

%Notes on Zyla 5.5 camera
%   Conversion gain modes: 1/4 (or 16 bit Rolling Shutter) = 0.6 e-/ADU
%   16 bit Global Shutter + 1.8 e-/ADU

function qe = iq_getcameraqe(desc, wavel)

%Camera name/description for Matching
cams = { ...
    'Zyla5',        'zyla\s{0,3}(vsc.+(00829|00369)|5)'...
};

%Match Camera name
camname = cams{~cellfun('isempty', regexpi(desc, cams(:,2), 'start')), 1};

%Gather Quantum Efficiency data for desired Camera
switch lower(camname)
    case 'zyla5'
        qe_data = zyla5_data;
end

%Interpolate to desired wavelengths
qe = interp1(qe_data(:,1), qe_data(:,2), wavel, 'linear', 'extrap');

end


%% Data repositories

function Zyla5 = zyla5_data()
%Data for the Andor Zyla 5.5, as: WaveLength, percent QE
%Extracted using DataThief from figure presented on Andor website
%   http://www.andor.com/images/zyla_qe.jpg
%   http://www.andor.com/scientific-cameras/neo-and-zyla-scmos-cameras/zyla-55-scmos
%
%DataThief L:\albeck\Notebooks\MichaelPargett\WorkingShare\Imaging
%   Quantification\zyla_qe.jpg Tuesday 26-Aug-2014 12:49:32 PM  
%
Zyla5 = [...
400.7812, 32.3406; ...
407.0313, 33.9304; ...
412.5, 35.6336; ...
418.75, 37.2801; ...
424.6094, 38.8699; ...
431.6406, 40.2897; ...
438.6719, 41.8229; ...
445.3125, 43.4128; ...
451.5625, 44.8324; ...
458.5937, 46.3657; ...
466.0156, 47.8423; ...
472.6562, 49.3754; ...
480.8594, 50.8521; ...
490.2344, 52.1022; ...
498.8281, 53.2953; ...
508.9844, 54.432; ...
518.75, 55.4551; ...
528.9062, 56.535; ...
539.8437, 57.5016; ...
551.5625, 58.2982; ...
563.6719, 58.8111; ...
575.0, 59.4374; ...
587.8906, 59.6099; ...
600.0, 59.4421; ...
612.5, 59.2175; ...
624.2187, 58.936; ...
635.5469, 58.3708; ...
647.6562, 57.5788; ...
658.9844, 56.6731; ...
668.75, 55.6537; ...
679.6875, 54.6912; ...
689.4531, 53.5016; ...
699.2187, 52.2551; ...
706.25, 51.0083; ...
714.4531, 49.5914; ...
722.6562, 48.061; ...
730.8594, 46.6441; ...
738.6719, 45.3406; ...
744.9219, 43.9234; ...
753.125, 42.393; ...
760.1562, 40.9759; ...
767.5781, 39.5021; ...
774.6094, 38.0283; ...
782.4219, 36.4411; ...
789.8437, 34.9673; ...
796.875, 33.4935; ...
804.6875, 31.963; ...
812.1094, 30.546; ...
819.5312, 29.0155; ...
826.1719, 27.7118; ...
834.375, 26.1247; ...
841.0156, 24.7643; ...
849.2187, 23.4041; ...
857.8125, 21.9872; ...
865.625, 20.5703; ...
873.0469, 19.0966; ...
881.6406, 17.6797; ...
889.0625, 16.2627; ...
897.2656, 14.9026; ...
905.4687, 13.6559; ...
914.0625, 12.2391; ...
922.6562, 11.0492; ...
932.4219, 9.8596; ...
942.1875, 8.6699; ...
952.7344, 7.6505; ...
962.8906, 6.688; ...
973.4375, 5.5553; ...
983.9844, 4.6495; ...
995.3125, 3.7438; ...
];
Zyla5(:,2) = Zyla5(:,2)./100;  %Adjustment to Fraction, from Percentage
end